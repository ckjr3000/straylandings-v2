---
layout: default.html
eleventyExcludeFromCollections: true
---
<div id="search-results"></div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const query = decodeURIComponent(new URLSearchParams(window.location.search).get('query'));
    const searchResultsDiv = document.getElementById('search-results');

    // Load your search index file
    fetch('../searchIndex.json')
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
        // Ensure data is an array
        if (!Array.isArray(data)) {
            throw new Error('Search index should be an array');
        }

        const fuse = new Fuse(data, {
            keys: ['title', 'content', 'author'],
            includeScore: true
        });

        const result = fuse.search(query);

        // Filter results to include only those with scores between 0.9 and 1
        const filteredResults = result.filter(({ score }) => score >= 0.97 && score <= 1);
       
        filteredResults.sort((a, b) => b.score - a.score);

        if (filteredResults.length > 0) {
            filteredResults.forEach(({ item, score }) => {
                const searchResult = document.createElement('div');
                searchResult.innerHTML = `
                    <h3>${item.title}</h3>
                    <p>Score: ${score.toFixed(2)}</p>
                    <p><a href="${item.url}">${item.url}</a></p>
                `;
                searchResultsDiv.appendChild(searchResult);
            });
        } else {
            searchResultsDiv.textContent = 'No results found';
        }
    })
    .catch(error => console.error('Error fetching search index:', error));
});
</script>

